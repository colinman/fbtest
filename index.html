<html>

<head>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="./src/facebox.js"></script>

<link rel="stylesheet" type="text/css" href="./src/facebox.css"/>

</head>

<body>

<div id="fb-root"></div>

<script>

$(document).ready(function() {

  $.facebox.settings.closeImage = 'src/closelabel.png';
  $.facebox.settings.loadingImage = 'src/loading.gif';

  window.fbAsyncInit = function() {
  FB.init({
          appId      : '180811402007050',
          status     : true,
          cookie     : true,
          xfbml      : true
  });

  FB.Event.subscribe('auth.authResponseChange', function(response) {
      if (response.status === 'connected') {
         var user_id;
         FB.api("/me", function(response) {
            user_id = response["id"];
            $('div#loginstatus').text("You are logged in. Your user id is " + user_id);
         });

         FB.api("/me/photos", function(response) {
            console.log("photos received");
            var photos = response["data"];
for(var i = 0; i < photos.length; i++) {            
photos[i] = photos[i]["source"];
}

show_images(photos);
            $('a[rel*=facebox]').facebox();
         });

      }
  });

};

(function(d, s, id){
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

});

function show_images(images) {
for(var i = 0; i < images.length; i++) {
var img_url = images[i];
$('div#images').append("<a href='" + img_url + "' rel='facebox'><div style='width:200px; height:200px; background-size:cover; background-repeat:no-repeat;  background-image:url(" + img_url + ");'></div></a>");
}

}

</script>

<div id="loginstatus"></div>
<fb:login-button show-faces="true" width="200" max-rows="1" scope="user_photos"></fb:login-button>

<div id="images">
</div>

</body>

</html>
